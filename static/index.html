<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ernie GameHub</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #fff5e6 0%, #ffe0b3 100%);
            min-height: 100vh;
            display: flex;
        }

        .sidebar {
            width: 280px;
            background: white;
            box-shadow: 4px 0 12px rgba(255, 140, 0, 0.1);
            padding: 32px 24px;
            overflow-y: auto;
        }

        .logo {
            font-size: 28px;
            font-weight: 700;
            color: #ff8c00;
            margin-bottom: 48px;
            letter-spacing: -0.5px;
        }

        .game-item {
            padding: 16px 20px;
            margin-bottom: 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            color: #666;
            border: 2px solid transparent;
        }

        .game-item:hover {
            background: #fff5e6;
            color: #ff8c00;
        }

        .game-item.active {
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            color: white;
            border-color: #ff8c00;
        }

        .main-content {
            flex: 1;
            padding: 48px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .game-container {
            background: white;
            border-radius: 24px;
            padding: 48px;
            box-shadow: 0 8px 32px rgba(255, 140, 0, 0.15);
            max-width: 600px;
            width: 100%;
        }

        .game-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .game-title {
            font-size: 32px;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }

        .game-subtitle {
            color: #999;
            font-size: 14px;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 32px auto;
            max-width: 360px;
        }

        .cell {
            aspect-ratio: 1;
            background: #f8f8f8;
            border: 3px solid #e0e0e0;
            border-radius: 16px;
            font-size: 48px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            color: #333;
        }

        .cell:hover:not(.taken) {
            background: #fff5e6;
            border-color: #ff8c00;
            transform: scale(1.05);
        }

        .cell.taken {
            cursor: not-allowed;
        }

        .status {
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            color: #666;
            margin-bottom: 24px;
            min-height: 28px;
        }

        .reset-btn {
            display: block;
            margin: 0 auto;
            padding: 14px 32px;
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 140, 0, 0.3);
        }

        .reset-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .lang-selector {
            position: absolute;
            top: 24px;
            right: 32px;
            display: flex;
            gap: 8px;
            background: white;
            padding: 8px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .lang-btn {
            padding: 8px 16px;
            border: 2px solid transparent;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            transition: all 0.2s;
        }

        .lang-btn.active {
            background: #ff8c00;
            color: white;
            border-color: #ff8c00;
        }

        .trivia-container {
            display: none;
        }

        .trivia-container.active {
            display: block;
        }

        .roleplay-container {
            display: none;
        }

        .roleplay-container.active {
            display: block;
        }

        .main-page-container {
            display: none;
            text-align: center;
        }

        .main-page-container.active {
            display: block;
        }

        .main-page-title {
            font-size: 48px;
            font-weight: 700;
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 24px;
        }

        .main-page-description {
            font-size: 18px;
            color: #666;
            line-height: 1.8;
            margin-bottom: 48px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .game-links {
            display: flex;
            flex-direction: column;
            gap: 16px;
            max-width: 400px;
            margin: 0 auto;
        }

        .game-link-btn {
            padding: 20px 32px;
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .game-link-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 140, 0, 0.3);
        }

        .game-link-btn::after {
            content: '‚Üí';
            font-size: 24px;
        }

        .about-container {
            display: none;
        }

        .about-container.active {
            display: block;
        }

        .about-text {
            font-size: 16px;
            color: #666;
            line-height: 1.8;
            margin-bottom: 32px;
        }

        .about-link {
            display: inline-block;
            color: #ff8c00;
            text-decoration: none;
            font-weight: 600;
            margin-bottom: 8px;
            transition: all 0.2s;
        }

        .about-link:hover {
            color: #ff6b00;
            text-decoration: underline;
        }

        .contact-section {
            margin-top: 32px;
            padding-top: 32px;
            border-top: 2px solid #e0e0e0;
        }

        .contact-title {
            font-size: 20px;
            font-weight: 700;
            color: #333;
            margin-bottom: 16px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            color: #666;
        }

        .contact-item a {
            color: #ff8c00;
            text-decoration: none;
            margin-left: 8px;
        }

        .contact-item a:hover {
            text-decoration: underline;
        }

        .character-input-section {
            margin-bottom: 32px;
        }

        .character-input {
            width: 100%;
            padding: 16px;
            font-size: 16px;
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            margin-bottom: 12px;
            transition: all 0.2s;
        }

        .character-input:focus {
            outline: none;
            border-color: #ff8c00;
            background: #fff5e6;
        }

        .start-roleplay-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .start-roleplay-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 140, 0, 0.3);
        }

        .start-roleplay-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .chat-container {
            display: none;
        }

        .chat-container.active {
            display: block;
        }

        .chat-messages {
            height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: #f8f8f8;
            border-radius: 12px;
            margin-bottom: 16px;
            border: 3px solid #e0e0e0;
        }

        .chat-message {
            margin-bottom: 16px;
            padding: 12px 16px;
            border-radius: 12px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .chat-message.user {
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            color: white;
            margin-left: auto;
            text-align: right;
        }

        .chat-message.assistant {
            background: white;
            border: 2px solid #e0e0e0;
            color: #333;
        }

        .chat-input-area {
            display: flex;
            gap: 12px;
        }

        .chat-input {
            flex: 1;
            padding: 14px;
            font-size: 16px;
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            transition: all 0.2s;
        }

        .chat-input:focus {
            outline: none;
            border-color: #ff8c00;
            background: #fff5e6;
        }

        .send-btn {
            padding: 14px 24px;
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .send-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 140, 0, 0.3);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .chat-controls {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        .clear-chat-btn {
            flex: 1;
            padding: 12px;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .clear-chat-btn:hover {
            background: #d32f2f;
        }

        .character-display {
            text-align: center;
            margin-bottom: 20px;
            padding: 12px;
            background: #fff5e6;
            border-radius: 12px;
            font-weight: 600;
            color: #ff8c00;
        }

        .question-box {
            padding: 32px;
            text-align: center;
            font-size: 20px;
            font-weight: 600;
            color: #333;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .answer-btn {
            display: block;
            width: 100%;
            padding: 18px;
            margin-bottom: 12px;
            background: #f8f8f8;
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            color: #333;
        }

        .answer-btn:hover:not(:disabled) {
            background: #fff5e6;
            border-color: #ff8c00;
        }

        .answer-btn.correct {
            background: #4caf50;
            border-color: #4caf50;
            color: white;
        }

        .answer-btn.wrong {
            background: #f44336;
            border-color: #f44336;
            color: white;
        }

        .answer-btn:disabled {
            cursor: not-allowed;
        }

        .score-container {
            display: flex;
            justify-content: space-around;
            margin-bottom: 24px;
        }

        .score-box {
            text-align: center;
            padding: 16px 24px;
            background: #f8f8f8;
            border-radius: 12px;
            border: 3px solid #e0e0e0;
        }

        .score-box.player {
            border-color: #4caf50;
        }

        .score-box.ai {
            border-color: #ff8c00;
        }

        .score-label {
            font-size: 14px;
            color: #999;
            margin-bottom: 4px;
        }

        .score-value {
            font-size: 32px;
            font-weight: 700;
            color: #333;
        }

        .round-info {
            text-align: center;
            font-size: 16px;
            color: #666;
            margin-bottom: 16px;
            font-weight: 600;
        }

        .explanation-box {
            background: #fff5e6;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            font-size: 15px;
            line-height: 1.6;
            color: #333;
        }

        .explanation-box strong {
            color: #ff8c00;
            display: block;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff8c00;
            animation: confetti-fall 3s ease-out forwards;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .win-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: white;
            padding: 48px;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            text-align: center;
            animation: modal-pop 0.5s ease-out forwards;
        }

        @keyframes modal-pop {
            0% {
                transform: translate(-50%, -50%) scale(0);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .win-modal h2 {
            font-size: 48px;
            margin-bottom: 16px;
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .win-modal p {
            font-size: 20px;
            color: #666;
            margin-bottom: 24px;
        }

        .lose-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: white;
            padding: 48px;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            text-align: center;
            animation: modal-shake 0.5s ease-out forwards;
        }

        @keyframes modal-shake {
            0%, 100% {
                transform: translate(-50%, -50%) scale(1);
            }
            10%, 30%, 50%, 70%, 90% {
                transform: translate(-48%, -50%) scale(1);
            }
            20%, 40%, 60%, 80% {
                transform: translate(-52%, -50%) scale(1);
            }
        }

        .lose-modal h2 {
            font-size: 48px;
            margin-bottom: 16px;
            color: #666;
        }

        .lose-modal p {
            font-size: 20px;
            color: #999;
            margin-bottom: 24px;
        }

        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            opacity: 0;
            animation: fade-in 0.3s ease-out forwards;
        }

        @keyframes fade-in {
            to {
                opacity: 1;
            }
        }
        /* PAGE VISIBILITY FIX */

.main-page-container,
.tictactoe-container,
.trivia-container,
.roleplay-container,
.about-container {
    display: none;
}

.main-page-container.active,
.tictactoe-container.active,
.trivia-container.active,
.roleplay-container.active,
.about-container.active {
    display: block;
}

    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo">Ernie GameHub</div>
        <div class="game-item active" data-game="main">
            <span class="game-name">Main</span>
        </div>
        <div class="game-item" data-game="tictactoe">
            <span class="game-name">Tic Tac Toe</span>
        </div>
        <div class="game-item" data-game="trivia">
            <span class="game-name">Two Truths One Lie</span>
        </div>
        <div class="game-item" data-game="roleplay">
            <span class="game-name">Role Play</span>
        </div>
        <div class="game-item" data-game="about">
            <span class="game-name">About</span>
        </div>
    </div>

    <div class="main-content">
        <div class="lang-selector">
            <button class="lang-btn active" data-lang="en">EN</button>
            <button class="lang-btn" data-lang="zh">‰∏≠Êñá</button>
        </div>

        <div class="game-container">
            <div id="main" class="main-page-container active">
                <div class="game-header">
                    <h1 class="main-page-title">Welcome to Ernie GameHub</h1>
                    <p class="main-page-description">
                        Experience the power of AI gaming with Ernie AI. Play interactive games, challenge yourself with trivia, and engage in roleplay conversations with your favorite characters.
                    </p>
                </div>
                <div class="game-links">
                    <button class="game-link-btn" data-target="tictactoe">
                        <span>Tic Tac Toe</span>
                    </button>
                    <button class="game-link-btn" data-target="trivia">
                        <span>Two Truths One Lie</span>
                    </button>
                    <button class="game-link-btn" data-target="roleplay">
                        <span>Role Play Chat</span>
                    </button>
                </div>
            </div>

            <div id="tictactoe" class="tictactoe-container">
                <div class="game-header">
                    <h1 class="game-title">Tic Tac Toe</h1>
                    <p class="game-subtitle">Play against AI</p>
                </div>
                <div class="status">Your turn</div>
                <div class="board">
                    <div class="cell" data-index="0"></div>
                    <div class="cell" data-index="1"></div>
                    <div class="cell" data-index="2"></div>
                    <div class="cell" data-index="3"></div>
                    <div class="cell" data-index="4"></div>
                    <div class="cell" data-index="5"></div>
                    <div class="cell" data-index="6"></div>
                    <div class="cell" data-index="7"></div>
                    <div class="cell" data-index="8"></div>
                </div>
                <button class="reset-btn">New Game</button>
            </div>

            <div id="trivia" class="trivia-container">
                <div class="game-header">
                    <h1 class="game-title">Two Truths One Lie</h1>
                    <p class="game-subtitle">Find the false statement</p>
                </div>
                <div class="round-info">Round <span id="current-round">1</span> / 5</div>
                <div class="score-container">
                    <div class="score-box player">
                        <div class="score-label">You</div>
                        <div class="score-value" id="player-score">0</div>
                    </div>
                    <div class="score-box ai">
                        <div class="score-label">AI</div>
                        <div class="score-value" id="ai-score">0</div>
                    </div>
                </div>
                <div class="question-box" id="question">Loading...</div>

                <button class="answer-btn" data-answer="0"></button>
                <button class="answer-btn" data-answer="1"></button>
                <button class="answer-btn" data-answer="2"></button>
                <div class="explanation-box" id="explanation" style="display: none;"></div>
                <button class="reset-btn" id="next-question">Next Round</button>
            </div>

            <div id="roleplay" class="roleplay-container">
                <div class="game-header">
                    <h1 class="game-title">Role Play Chat</h1>
                    <p class="game-subtitle">Chat with your favorite characters</p>
                </div>

                <div class="character-input-section" id="character-input-section">
                    <input
                        type="text"
                        class="character-input"
                        id="character-input"
                        placeholder='e.g. "Luffy from One Piece"'
                    />
                    <button class="start-roleplay-btn" id="start-roleplay-btn">Start Chat</button>
                </div>

                <div class="chat-container" id="chat-container">
                    <div class="character-display" id="character-display"></div>
                    <div class="chat-messages" id="chat-messages"></div>
                    <div class="chat-input-area">
                        <input
                            type="text"
                            class="chat-input"
                            id="chat-input"
                            placeholder="Type your message..."
                        />
                        <button class="send-btn" id="send-btn">Send</button>
                    </div>
                    <div class="chat-controls">
                        <button class="clear-chat-btn" id="clear-chat-btn">Clear Chat & Change Character</button>
                    </div>
                </div>
            </div>

            <div id="about" class="about-container">
                <div class="game-header">
                    <h1 class="game-title">About This Project</h1>
                </div>
                <div class="about-text">
                    <p style="margin-bottom: 20px;">
                        This project was created for the <strong>Ernie AI Developer Challenge</strong> hackathon, showcasing the capabilities of Ernie AI in creating engaging and interactive gaming experiences.
                    </p>
                    <p style="margin-bottom: 20px;">
I used the ultra-lightweight Simple ERNIE Bot through the Gradio API (https://huggingface.co/spaces/baidu/simple_ernie_bot_demo
).
The model is not designed for performance or production use and serves only as a basic demo for testing purposes. Therefore, its performance may not be perfect, but it is sufficient for demonstrating the game concept and minigame integration.                    </p>
                    <p style="margin-bottom: 20px;">
                        <a href="https://baiduernieai.devpost.com" target="_blank" class="about-link">
                            View Hackathon Details
                        </a>
                    </p>
                </div>
                <div class="contact-section">
                    <h3 class="contact-title">GitHub</h3>
                    <div class="contact-item">
                        <strong>GitHub Repo:</strong>
                        <a href="https://github.com/MRamazan/Ernie-GameHub" target="_blank">https://github.com/MRamazan/Ernie-GameHub</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = '/api';

        let startingPlayer = 'X';

        const translations = {
            en: {
                main: 'Main',
                tictactoe: 'Tic Tac Toe',
                trivia: 'Two Truths One Lie',
                roleplay: 'Role Play',
                about: 'About',
                welcomeTitle: 'Welcome to Ernie GameHub',
                welcomeDesc: 'Experience the power of AI gaming with Ernie AI. Play interactive games, challenge yourself with trivia, and engage in roleplay conversations with your favorite characters.',
                aboutTitle: 'About This Project',
                aboutText: 'This project was created for the <strong>Ernie AI Developer Challenge</strong> hackathon, showcasing the capabilities of Ernie AI in creating engaging and interactive gaming experiences.',
                hackathonLink: 'üèÜ View Hackathon Details',
                contactTitle: 'Get in Touch',
                playAgainstAI: 'Play against AI',
                findFalse: 'Find the false statement',
                chatWithCharacters: 'Chat with your favorite characters',
                yourTurn: 'Your turn',
                aiThinking: 'Ernie is thinking...',
                youWin: 'You win!',
                aiWins: 'Ernie wins!',
                draw: 'Draw!',
                newGame: 'New Game',
                nextRound: 'Next Round',
                loading: 'Loading...',
                whichFalse: 'Which statement is false?',
                round: 'Round',
                you: 'You',
                ai: 'AI',
                gameOver: 'Game Over!',
                finalScore: 'Final Score',
                playAgain: 'Play Again',
                enterCharacter: 'e.g. "Luffy from One Piece"',
                startChat: 'Start Chat',
                typeMessage: 'Type your message...',
                send: 'Send',
                clearChat: 'Clear Chat & Change Character'
            },
            zh: {
                main: '‰∏ªÈ°µ',
                tictactoe: '‰∫ïÂ≠óÊ£ã',
                trivia: '‰∏§Áúü‰∏ÄÂÅá',
                roleplay: 'ËßíËâ≤ÊâÆÊºî',
                about: 'ÂÖ≥‰∫é',
                welcomeTitle: 'Ê¨¢ËøéÊù•Âà∞ErnieÊ∏∏Êàè‰∏≠ÂøÉ',
                welcomeDesc: '‰ΩìÈ™åErnie AIÁöÑÊ∏∏ÊàèÂäõÈáè„ÄÇÁé©‰∫íÂä®Ê∏∏ÊàèÔºåÊåëÊàòÁêê‰∫ãÈóÆÁ≠îÔºåÂπ∂‰∏é‰Ω†ÊúÄÂñúÊ¨¢ÁöÑËßíËâ≤ËøõË°åËßíËâ≤ÊâÆÊºîÂØπËØù„ÄÇ',
                aboutTitle: 'ÂÖ≥‰∫éÊ≠§È°πÁõÆ',
                aboutText: 'Ê≠§È°πÁõÆÊòØ‰∏∫<strong>Ernie AIÂºÄÂèëËÄÖÊåëÊàòËµõ</strong>ÈªëÂÆ¢ÊùæÂàõÂª∫ÁöÑÔºåÂ±ïÁ§∫‰∫ÜErnie AIÂú®ÂàõÂª∫Âºï‰∫∫ÂÖ•ËÉúÁöÑ‰∫íÂä®Ê∏∏Êàè‰ΩìÈ™åÊñπÈù¢ÁöÑËÉΩÂäõ„ÄÇ',
                hackathonLink: 'üèÜ Êü•ÁúãÈªëÂÆ¢ÊùæËØ¶ÊÉÖ',
                contactTitle: 'ËÅîÁ≥ªÊñπÂºè',
                playAgainstAI: '‰∏éErnieÂØπÊàò',
                findFalse: 'ÊâæÂá∫ÈîôËØØÁöÑÈôàËø∞',
                chatWithCharacters: '‰∏é‰Ω†ÂñúÊ¨¢ÁöÑËßíËâ≤ËÅäÂ§©',
                yourTurn: '‰Ω†ÁöÑÂõûÂêà',
                aiThinking: 'ErnieÊÄùËÄÉ‰∏≠...',
                youWin: '‰Ω†Ëµ¢‰∫ÜÔºÅ',
                aiWins: 'ErnieËµ¢‰∫ÜÔºÅ',
                draw: 'Âπ≥Â±ÄÔºÅ',
                newGame: 'Êñ∞Ê∏∏Êàè',
                nextRound: '‰∏ã‰∏ÄËΩÆ',
                loading: 'Âä†ËΩΩ‰∏≠...',
                whichFalse: 'Âì™‰∏™ÈôàËø∞ÊòØÈîôËØØÁöÑÔºü',
                round: 'ÂõûÂêà',
                you: '‰Ω†',
                ai: 'AI',
                gameOver: 'Ê∏∏ÊàèÁªìÊùüÔºÅ',
                finalScore: 'ÊúÄÁªàÂæóÂàÜ',
                playAgain: 'ÂÜçÁé©‰∏ÄÊ¨°',
                enterCharacter: '‰æãÂ¶ÇÔºö"Êµ∑Ë¥ºÁéãÁöÑË∑ØÈ£û"',
                startChat: 'ÂºÄÂßãËÅäÂ§©',
                typeMessage: 'ËæìÂÖ•‰Ω†ÁöÑÊ∂àÊÅØ...',
                send: 'ÂèëÈÄÅ',
                clearChat: 'Ê∏ÖÈô§ËÅäÂ§©Âπ∂Êõ¥Êç¢ËßíËâ≤'
            }
        };

        let currentLang = 'en';
        let board = [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '];
        let gameActive = true;
        let playerScore = 0;
        let aiScore = 0;
        let currentRound = 1;
        let maxRounds = 5;
        let currentCharacter = '';
        let sessionId = 'session_' + Date.now();

        function updateLanguage() {
            const t = translations[currentLang];

            const gameItems = document.querySelectorAll('.game-item .game-name');
            if (gameItems[0]) gameItems[0].textContent = t.main;
            if (gameItems[1]) gameItems[1].textContent = t.tictactoe;
            if (gameItems[2]) gameItems[2].textContent = t.trivia;
            if (gameItems[3]) gameItems[3].textContent = t.roleplay;
            if (gameItems[4]) gameItems[4].textContent = t.about;

            const mainTitle = document.querySelector('#main .main-page-title');
            if (mainTitle) mainTitle.textContent = t.welcomeTitle;

            const mainDesc = document.querySelector('#main .main-page-description');
            if (mainDesc) mainDesc.textContent = t.welcomeDesc;

            const gameLinkBtns = document.querySelectorAll('.game-link-btn span');
            if (gameLinkBtns[0]) gameLinkBtns[0].textContent = t.tictactoe;
            if (gameLinkBtns[1]) gameLinkBtns[1].textContent = t.trivia;
            if (gameLinkBtns[2]) gameLinkBtns[2].textContent = t.roleplay;

            const aboutTitle = document.querySelector('#about .game-title');
            if (aboutTitle) aboutTitle.textContent = t.aboutTitle;

            const aboutText = document.querySelector('#about .about-text p');
            if (aboutText) aboutText.innerHTML = t.aboutText;

            const hackathonLink = document.querySelector('#about .about-link');
            if (hackathonLink) hackathonLink.textContent = t.hackathonLink;

            const contactTitle = document.querySelector('#about .contact-title');
            if (contactTitle) contactTitle.textContent = t.contactTitle;

            const tttTitle = document.querySelector('#tictactoe .game-title');
            if (tttTitle) tttTitle.textContent = t.tictactoe;

            const tttSubtitle = document.querySelector('#tictactoe .game-subtitle');
            if (tttSubtitle) tttSubtitle.textContent = t.playAgainstAI;

            const tttResetBtn = document.querySelector('#tictactoe .reset-btn');
            if (tttResetBtn) tttResetBtn.textContent = t.newGame;

            const triviaTitle = document.querySelector('#trivia .game-title');
            if (triviaTitle) triviaTitle.textContent = t.trivia;

            const triviaSubtitle = document.querySelector('#trivia .game-subtitle');
            if (triviaSubtitle) triviaSubtitle.textContent = t.findFalse;

            const nextQuestion = document.getElementById('next-question');
            if (nextQuestion) nextQuestion.textContent = t.nextRound;

            const playerLabel = document.querySelector('.score-box.player .score-label');
            if (playerLabel) playerLabel.textContent = t.you;

            const aiLabel = document.querySelector('.score-box.ai .score-label');
            if (aiLabel) aiLabel.textContent = t.ai;

            const roundInfo = document.querySelector('.round-info');
            if (roundInfo) {
                const roundSpan = document.getElementById('current-round');
                if (roundSpan) {
                    roundInfo.innerHTML = `${t.round} <span id="current-round">${roundSpan.textContent}</span> / 5`;
                }
            }

            const roleplayTitle = document.querySelector('#roleplay .game-title');
            if (roleplayTitle) roleplayTitle.textContent = t.roleplay;

            const roleplaySubtitle = document.querySelector('#roleplay .game-subtitle');
            if (roleplaySubtitle) roleplaySubtitle.textContent = t.chatWithCharacters;

            const charInput = document.querySelector('#character-input');
            if (charInput) charInput.placeholder = t.enterCharacter;

            const startBtn = document.querySelector('#start-roleplay-btn');
            if (startBtn) startBtn.textContent = t.startChat;

            const chatInput = document.querySelector('#chat-input');
            if (chatInput) chatInput.placeholder = t.typeMessage;

            const sendBtn = document.querySelector('#send-btn');
            if (sendBtn) sendBtn.textContent = t.send;

            const clearBtn = document.querySelector('#clear-chat-btn');
            if (clearBtn) clearBtn.textContent = t.clearChat;

            const status = document.querySelector('.status');
            if (gameActive && status) {
                status.textContent = t.yourTurn;
            }
        }

        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentLang = btn.dataset.lang;
                updateLanguage();
            });
        });

        const pages = ['main', 'tictactoe', 'trivia', 'roleplay', 'about'];

document.querySelectorAll('.game-item').forEach(item => {
    item.addEventListener('click', () => {
        // sidebar active
        document.querySelectorAll('.game-item').forEach(i =>
            i.classList.remove('active')
        );
        item.classList.add('active');

        // hide all pages
        pages.forEach(p =>
            document.getElementById(p).classList.remove('active')
        );

        // show selected page
        const page = item.dataset.game;
        document.getElementById(page).classList.add('active');

        // page specific logic
        if (page === 'trivia') {
            resetTriviaGame();
            loadTriviaQuestion();
        }

        if (page === 'roleplay' && !currentCharacter) {
            document.getElementById('character-input-section').style.display = 'block';
            document.getElementById('chat-container').classList.remove('active');
        }
    });
});


        document.querySelectorAll('.game-link-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const target = btn.dataset.target;
                const targetItem = document.querySelector(`.game-item[data-game="${target}"]`);
                if (targetItem) {
                    targetItem.click();
                }
            });
        });

        function checkWinner(b, p) {
            const wins = [
                [0,1,2],[3,4,5],[6,7,8],
                [0,3,6],[1,4,7],[2,5,8],
                [0,4,8],[2,4,6]
            ];
            return wins.some(([a,b_,c]) => b[a]===p && b[b_]===p && b[c]===p);
        }

        function boardFull() {
            return board.every(cell => cell !== ' ');
        }

        async function aiMove() {
            const t = translations[currentLang];
            document.querySelector('.status').textContent = t.aiThinking;

            const resetBtn = document.querySelector('#tictactoe .reset-btn');
            resetBtn.disabled = true;

            try {
                const response = await fetch(`${API_BASE}/ai-move`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ board: board })
                });

                const data = await response.json();

                if (data.success) {
                    board = data.board;
                    document.querySelector(`.cell[data-index="${data.move}"]`).textContent = 'O';
                    document.querySelector(`.cell[data-index="${data.move}"]`).classList.add('taken');

                    if (data.winner === 'O') {
                        document.querySelector('.status').textContent = t.aiWins;
                        gameActive = false;
                        showLoseModal(t.aiWins, t.newGame);
                    } else if (data.winner === 'draw') {
                        document.querySelector('.status').textContent = t.draw;
                        gameActive = false;
                    } else {
                        document.querySelector('.status').textContent = t.yourTurn;
                    }
                } else {
                    console.error('AI move failed');
                }
            } catch (error) {
                console.error('Error:', error);
            } finally {
                resetBtn.disabled = false;
            }
        }

        document.querySelectorAll('.cell').forEach(cell => {
            cell.addEventListener('click', async () => {
                const t = translations[currentLang];
                const index = parseInt(cell.dataset.index);

                if (board[index] === ' ' && gameActive) {
                    board[index] = 'X';
                    cell.textContent = 'X';
                    cell.classList.add('taken');

                    if (checkWinner(board, 'X')) {
                        document.querySelector('.status').textContent = t.youWin;
                        gameActive = false;
                        showWinModal(t.youWin, t.newGame);
                        return;
                    }

                    if (boardFull()) {
                        document.querySelector('.status').textContent = t.draw;
                        gameActive = false;
                        return;
                    }

                    await aiMove();
                }
            });
        });

        document.querySelector('#tictactoe .reset-btn').addEventListener('click', () => {
            board = [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '];
            gameActive = true;

            document.querySelectorAll('.cell').forEach(cell => {
                cell.textContent = '';
                cell.classList.remove('taken');
            });

            startingPlayer = startingPlayer === 'X' ? 'O' : 'X';

            if (startingPlayer === 'X') {
                document.querySelector('.status').textContent = translations[currentLang].yourTurn;
            } else {
                document.querySelector('.status').textContent = translations[currentLang].aiThinking;
                setTimeout(aiMove, 400);
            }
        });

        async function loadTriviaQuestion() {
            const t = translations[currentLang];
            document.getElementById('question').textContent = "Ernie is generating statements...";
            document.getElementById('explanation').style.display = 'none';

            const answerBtns = document.querySelectorAll('.answer-btn');
            answerBtns.forEach(btn => {
                btn.textContent = '';
                btn.disabled = true;
                btn.classList.remove('correct', 'wrong');
            });

            const nextBtn = document.getElementById('next-question');
            nextBtn.disabled = true;

            try {
                const response = await fetch(`${API_BASE}/trivia`);
                const data = await response.json();

                if (data.statements) {
                    document.getElementById('question').textContent = t.whichFalse;

                    answerBtns.forEach((btn, idx) => {
                        btn.textContent = data.statements[idx];
                        btn.disabled = false;
                        btn.onclick = () => checkAnswer(idx, data.lie, data.explanation);
                    });
                } else {
                    document.getElementById('question').textContent = 'Error loading question';
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('question').textContent = 'Error loading question';
            } finally {
                nextBtn.disabled = false;
            }
        }

        function checkAnswer(selected, correct, explanation) {
            const t = translations[currentLang];
            const buttons = document.querySelectorAll('.answer-btn');

            buttons.forEach((btn, idx) => {
                btn.disabled = true;

                if (idx === correct) {
                    btn.classList.add('wrong');
                } else {
                    btn.classList.add('correct');
                }
            });

            const explanationBox = document.getElementById('explanation');
            explanationBox.innerHTML = `<strong>Explanation:</strong> ${explanation || 'No explanation available.'}`;
            explanationBox.style.display = 'block';

            if (selected === correct) {
                playerScore++;
                document.getElementById('player-score').textContent = playerScore;
            } else {
                aiScore++;
                document.getElementById('ai-score').textContent = aiScore;
            }

            if (currentRound >= maxRounds) {
                setTimeout(() => {
                    if (playerScore > aiScore) {
                        showWinModal(t.youWin, `${t.finalScore}: ${playerScore} - ${aiScore}`, t.playAgain);
                    } else if (aiScore > playerScore) {
                        showLoseModal(t.aiWins, `${t.finalScore}: ${playerScore} - ${aiScore}`, t.playAgain);
                    } else {
                        showDrawModal(t.draw, `${t.finalScore}: ${playerScore} - ${aiScore}`, t.playAgain);
                    }
                }, 1500);
            }
        }

        document.getElementById('next-question').addEventListener('click', () => {
            if (currentRound >= maxRounds) {
                resetTriviaGame();
            } else {
                currentRound++;
                document.getElementById('current-round').textContent = currentRound;
                loadTriviaQuestion();
            }
            updateLanguage();
        });

        function resetTriviaGame() {
            currentRound = 1;
            playerScore = 0;
            aiScore = 0;
            document.getElementById('current-round').textContent = currentRound;
            document.getElementById('player-score').textContent = playerScore;
            document.getElementById('ai-score').textContent = aiScore;
            loadTriviaQuestion();
        }

        document.getElementById('start-roleplay-btn').addEventListener('click', async () => {
            const character = document.getElementById('character-input').value.trim();
            if (!character) return;

            currentCharacter = character;
            const btn = document.getElementById('start-roleplay-btn');
            btn.disabled = true;
            btn.textContent = 'Starting...';

            try {
                const response = await fetch(`${API_BASE}/roleplay/start`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ character, session_id: sessionId })
                });

                const data = await response.json();

                if (data.success) {
                    document.getElementById('character-input-section').style.display = 'none';
                    document.getElementById('chat-container').classList.add('active');
                    document.getElementById('character-display').textContent = `Chatting with: ${character}`;

                    const messagesDiv = document.getElementById('chat-messages');
                    messagesDiv.innerHTML = `<div class="chat-message assistant">${data.message}</div>`;
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Failed to start roleplay. Please try again.');
            } finally {
                btn.disabled = false;
                btn.textContent = translations[currentLang].startChat;
            }
        });

        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (!message) return;

            const messagesDiv = document.getElementById('chat-messages');
            messagesDiv.innerHTML += `<div class="chat-message user">${message}</div>`;
            input.value = '';
            messagesDiv.scrollTop = messagesDiv.scrollHeight;

            const sendBtn = document.getElementById('send-btn');
            sendBtn.disabled = true;

            try {
                const response = await fetch(`${API_BASE}/roleplay/chat`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message,
                        character: currentCharacter,
                        session_id: sessionId
                    })
                });

                const data = await response.json();

                if (data.success) {
                    messagesDiv.innerHTML += `<div class="chat-message assistant">${data.message}</div>`;
                    messagesDiv.scrollTop = messagesDiv.scrollHeight;
                }
            } catch (error) {
                console.error('Error:', error);
                messagesDiv.innerHTML += `<div class="chat-message assistant">Sorry, there was an error. Please try again.</div>`;
            } finally {
                sendBtn.disabled = false;
            }
        }

        document.getElementById('send-btn').addEventListener('click', sendMessage);

        document.getElementById('chat-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        document.getElementById('clear-chat-btn').addEventListener('click', async () => {
            try {
                await fetch(`${API_BASE}/roleplay/clear`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ session_id: sessionId })
                });
            } catch (error) {
                console.error('Error:', error);
            }

            sessionId = 'session_' + Date.now();
            currentCharacter = '';
            document.getElementById('character-input').value = '';
            document.getElementById('chat-messages').innerHTML = '';
            document.getElementById('character-input-section').style.display = 'block';
            document.getElementById('chat-container').classList.remove('active');
        });

        function createConfetti() {
            const colors = ['#ff8c00', '#ff6b00', '#ffa500', '#ffb347', '#ffd700'];
            const celebration = document.createElement('div');
            celebration.className = 'celebration';

            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 0.5 + 's';
                confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                celebration.appendChild(confetti);
            }

            document.body.appendChild(celebration);
            setTimeout(() => celebration.remove(), 3000);
        }

        function showWinModal(title, message, btnText) {
            createConfetti();

            const backdrop = document.createElement('div');
            backdrop.className = 'modal-backdrop';

            const modal = document.createElement('div');
            modal.className = 'win-modal';
            modal.innerHTML = `
                <h2>${title}</h2>
                <button class="reset-btn" onclick="closeModal()">New Game</button>
            `;

            document.body.appendChild(backdrop);
            document.body.appendChild(modal);
        }

        function showLoseModal(title, message, btnText) {
            const backdrop = document.createElement('div');
            backdrop.className = 'modal-backdrop';

            const modal = document.createElement('div');
            modal.className = 'lose-modal';
            modal.innerHTML = `
                <h2>${title}</h2>
                <button class="reset-btn" onclick="closeModal()">New Game</button>
            `;

            document.body.appendChild(backdrop);
            document.body.appendChild(modal);
        }

        function showDrawModal(title, message, btnText) {
            const backdrop = document.createElement('div');
            backdrop.className = 'modal-backdrop';

            const modal = document.createElement('div');
            modal.className = 'win-modal';
            modal.innerHTML = `
                <h2>${title}</h2>
                <p>${message}</p>
                <button class="reset-btn" onclick="closeModal()">${btnText}</button>
            `;

            document.body.appendChild(backdrop);
            document.body.appendChild(modal);
        }

        function closeModal() {
            const activeGame = document.querySelector('.game-item.active').dataset.game;
            document.querySelectorAll('.modal-backdrop, .win-modal, .lose-modal').forEach(el => el.remove());

            if (activeGame === 'tictactoe') {
                board = [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '];
                gameActive = true;
                document.querySelectorAll('.cell').forEach(cell => {
                    cell.textContent = '';
                    cell.classList.remove('taken');
                });
                document.querySelector('.status').textContent = translations[currentLang].yourTurn;
            } else {
                resetTriviaGame();
            }
        }
    </script>
</body>
</html>
